<div class="flex justify-center items-center h-full">
  <form class="w-full max-w-sm" [formGroup]="form" (ngSubmit)="step === 1 ? onRequestCode() : onSubmit()">
    <h4 class="text-center text-3xl font-bold mb-6">Recupero password</h4>
    
    <ng-container *ngIf="step === 1">
      <mat-form-field class="w-full" appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput type="email" placeholder="Email" formControlName="email" required>
        <mat-icon matSuffix>email</mat-icon>
        <mat-error *ngIf="form.get('email')?.hasError('required')">Email obbligatoria</mat-error>
        <mat-error *ngIf="form.get('email')?.hasError('email')">Email non valida</mat-error>
      </mat-form-field>
      <div class="flex justify-end">
        <button mat-raised-button color="primary" type="submit" [disabled]="form.get('email')?.invalid">Ricevi codice</button>
      </div>
    </ng-container>

    <ng-container *ngIf="step === 2">
      <mat-form-field class="w-full" appearance="outline">
        <mat-label>Codice di conferma</mat-label>
        <input matInput type="text" placeholder="Codice di conferma" formControlName="confirmationCode" required>
        <mat-icon matSuffix>confirmation_number</mat-icon>
        <mat-error *ngIf="form.get('confirmationCode')?.hasError('required')">Codice di conferma obbligatorio</mat-error>
      </mat-form-field>
      <mat-form-field class="w-full" appearance="outline">
        <mat-label>Nuova password</mat-label>
        <input matInput type="password" placeholder="Nuova password" formControlName="newPassword" required>
        <mat-icon matSuffix>lock</mat-icon>
        <mat-error *ngIf="form.get('newPassword')?.hasError('required')">Nuova password obbligatoria</mat-error>
        <mat-error *ngIf="form.get('newPassword')?.hasError('minlength')">La password deve essere di almeno 6 caratteri</mat-error>
      </mat-form-field>
      <div class="flex justify-end">
        <button mat-flat-button color="primary" type="submit" [disabled]="form.invalid">Invia</button>
      </div>
    </ng-container>
  </form>
</div>
